
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nominatim.org/customize/Tokenizers/">
      
      
        <link rel="prev" href="../Importance/">
      
      
        <link rel="next" href="../Special-Phrases/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Tokenizers - Nominatim 5.1.0 Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra.css">
    
      <link rel="stylesheet" href="../../styles.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tokenizers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nominatim 5.1.0 Manual" class="md-header__button md-logo" aria-label="Nominatim 5.1.0 Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nominatim 5.1.0 Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tokenizers
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openstreetmap/Nominatim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/Overview/" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../admin/Installation/" class="md-tabs__link">
          
  
  Administration Guide

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Overview/" class="md-tabs__link">
          
  
  Customization Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../library/Getting-Started/" class="md-tabs__link">
          
  
  Library Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../develop/overview/" class="md-tabs__link">
          
  
  Developers Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nominatim 5.1.0 Manual" class="md-nav__button md-logo" aria-label="Nominatim 5.1.0 Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nominatim 5.1.0 Manual
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openstreetmap/Nominatim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Reverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Lookup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Address Lookup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Details
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Place Output Formats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administration Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administration Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Import/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Deployment-Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Setup-Nominatim-UI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nominatim UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Advanced-Installations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Installations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration from older Versions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Install-on-Ubuntu-22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation on Ubuntu 22
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Install-on-Ubuntu-24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation on Ubuntu 24
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Customization Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Customization Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Import-Styles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import Styles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Result-Formatting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Result Formatting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Country-Settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Per-Country Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ranking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Place Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Importance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tokenizers
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tokenizers
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#icu-tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      ICU tokenizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ICU tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      How it works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#query-preprocessing" class="md-nav__link">
    <span class="md-ellipsis">
      Query preprocessing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#normalization-and-transliteration" class="md-nav__link">
    <span class="md-ellipsis">
      Normalization and Transliteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sanitizers" class="md-nav__link">
    <span class="md-ellipsis">
      Sanitizers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-tags" class="md-nav__link">
    <span class="md-ellipsis">
      delete-tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag-japanese" class="md-nav__link">
    <span class="md-ellipsis">
      tag-japanese
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Token Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reconfiguration" class="md-nav__link">
    <span class="md-ellipsis">
      Reconfiguration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Special-Phrases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Special Phrases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tiger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External data: US housenumbers from TIGER
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Postcodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External data: Postcodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SQLite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion to SQLite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Library Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Library Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Getting-Started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/NominatimAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nominatim API class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Input-Parameter-Types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Parameter Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Result-Handling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Result Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Low-Level-DB-Access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Low-level DB Access
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developers Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Database-Layout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Layout
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Indexing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Tokenizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tokenizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/ICU-Tokenizer-Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom modules for ICU tokenizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Development-Environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup for Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/data-sources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Data Sources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="tokenizers">Tokenizers<a class="headerlink" href="#tokenizers" title="Permanent link">🔗</a></h1>
<p>The tokenizer module in Nominatim is responsible for analysing the names given
to OSM objects and the terms of an incoming query in order to make sure, they
can be matched appropriately.</p>
<p>Nominatim currently offers only one tokenizer module, the ICU tokenizer. This section
describes the tokenizer and how it can be configured.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The selection of tokenizer is tied to a database installation. You need to choose
and configure the tokenizer before starting the initial import. Once the import
is done, you cannot switch to another tokenizer anymore. Reconfiguring the
chosen tokenizer is very limited as well. See the comments in each tokenizer
section.</p>
</div>
<h2 id="icu-tokenizer">ICU tokenizer<a class="headerlink" href="#icu-tokenizer" title="Permanent link">🔗</a></h2>
<p>The ICU tokenizer uses the <a href="http://site.icu-project.org/">ICU library</a> to
normalize names and queries. It also offers configurable decomposition and
abbreviation handling.
This tokenizer is currently the default.</p>
<p>To enable the tokenizer add the following line to your project configuration:</p>
<div class="highlight"><pre><span></span><code>NOMINATIM_TOKENIZER=icu
</code></pre></div>
<h3 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link">🔗</a></h3>
<p>On import the tokenizer processes names in the following three stages:</p>
<ol>
<li>During the <strong>Sanitizer step</strong> incoming names are cleaned up and converted to
   <strong>full names</strong>. This step can be used to regularize spelling, split multi-name
   tags into their parts and tag names with additional attributes. See the
   <a href="#sanitizers">Sanitizers section</a> below for available cleaning routines.</li>
<li>The <strong>Normalization</strong> part removes all information from the full names
   that are not relevant for search.</li>
<li>The <strong>Token analysis</strong> step takes the normalized full names and creates
   all transliterated variants under which the name should be searchable.
   See the <a href="#token-analysis">Token analysis</a> section below for more
   information.</li>
</ol>
<p>During query time, the tokeinzer is responsible for processing incoming
queries. This happens in two stages:</p>
<ol>
<li>During <strong>query preprocessing</strong> the incoming text is split into name
   chunks and normalised. This usually means applying the same normalisation
   as during the import process but may involve other processing like,
   for example, word break detection.</li>
<li>The <strong>token analysis</strong> step breaks down the query parts into tokens,
   looks them up in the database and assigns them possible functions and
   probabilities.</li>
</ol>
<p>Query processing can be further customized while the rest of the analysis
is hard-coded.</p>
<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">🔗</a></h3>
<p>The ICU tokenizer is configured using a YAML file which can be configured using
<code>NOMINATIM_TOKENIZER_CONFIG</code>. The configuration is read on import and then
saved as part of the internal database status. Later changes to the variable
have no effect.</p>
<p>Here is an example configuration file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">query-preprocessing</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normalize</span>
<span class="nt">normalization</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;::</span><span class="nv"> </span><span class="s">lower</span><span class="nv"> </span><span class="s">()&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;ß</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">&#39;ss&#39;&quot;</span><span class="w"> </span><span class="c1"># German szet is unambiguously equal to double ss</span>
<span class="nt">transliteration</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/nominatim/icu-rules/extended-unicode-to-asccii.yaml</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;::</span><span class="nv"> </span><span class="s">Ascii</span><span class="nv"> </span><span class="s">()&quot;</span>
<span class="nt">sanitizers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">split-name-list</span>
<span class="nt">token-analysis</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">analyzer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generic</span>
<span class="w">      </span><span class="nt">variants</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">icu-rules/variants-ca.yaml</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">words</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">road -&gt; rd</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bridge -&gt; bdge,br,brdg,bri,brg</span>
<span class="w">      </span><span class="nt">mutations</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;ä&#39;</span>
<span class="w">            </span><span class="nt">replacements</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;ä&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ae&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>The configuration file contains four sections:
<code>normalization</code>, <code>transliteration</code>, <code>sanitizers</code> and <code>token-analysis</code>.</p>
<h4 id="query-preprocessing">Query preprocessing<a class="headerlink" href="#query-preprocessing" title="Permanent link">🔗</a></h4>
<p>The section for <code>query-preprocessing</code> defines an ordered list of functions
that are applied to the query before the token analysis.</p>
<p>The following is a list of preprocessors that are shipped with Nominatim.</p>
<h5 id="normalize">normalize<a class="headerlink" href="#normalize" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_api.query_preprocessing.normalize"></a>
    <div class="doc doc-contents first">

        <p>Normalize query text using the same ICU normalization rules that are
applied during import. If a phrase becomes empty because the normalization
removes all terms, then the phrase is deleted.</p>
<p>This preprocessor does not come with any extra information. Instead it will
use the configuration from the <code>normalization</code> section.</p>








  <div class="doc doc-children">











  </div>

    </div>

</div><h4 id="normalization-and-transliteration">Normalization and Transliteration<a class="headerlink" href="#normalization-and-transliteration" title="Permanent link">🔗</a></h4>
<p>The normalization and transliteration sections each define a set of
ICU rules that are applied to the names.</p>
<p>The <strong>normalization</strong> rules are applied after sanitation. They should remove
any information that is not relevant for search at all. Usual rules to be
applied here are: lower-casing, removing of special characters, cleanup of
spaces.</p>
<p>The <strong>transliteration</strong> rules are applied at the end of the tokenization
process to transfer the name into an ASCII representation. Transliteration can
be useful to allow for further fuzzy matching, especially between different
scripts.</p>
<p>Each section must contain a list of
<a href="https://unicode-org.github.io/icu/userguide/transforms/general/rules.html">ICU transformation rules</a>.
The rules are applied in the order in which they appear in the file.
You can also include additional rules from external yaml file using the
<code>!include</code> tag. The included file must contain a valid YAML list of ICU rules
and may again include other files.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The ICU rule syntax contains special characters that conflict with the
YAML syntax. You should therefore always enclose the ICU rules in
double-quotes.</p>
</div>
<h4 id="sanitizers">Sanitizers<a class="headerlink" href="#sanitizers" title="Permanent link">🔗</a></h4>
<p>The sanitizers section defines an ordered list of functions that are applied
to the name and address tags before they are further processed by the tokenizer.
They allows to clean up the tagging and bring it to a standardized form more
suitable for building the search index.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Sanitizers only have an effect on how the search index is built. They
do not change the information about each place that is saved in the
database. In particular, they have no influence on how the results are
displayed. The returned results always show the original information as
stored in the OpenStreetMap database.</p>
</div>
<p>Each entry contains information of a sanitizer to be applied. It has a
mandatory parameter <code>step</code> which gives the name of the sanitizer. Depending
on the type, it may have additional parameters to configure its operation.</p>
<p>The order of the list matters. The sanitizers are applied exactly in the order
that is configured. Each sanitizer works on the results of the previous one.</p>
<p>The following is a list of sanitizers that are shipped with Nominatim.</p>
<h5 id="split-name-list">split-name-list<a class="headerlink" href="#split-name-list" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.split_name_list"></a>
    <div class="doc doc-contents first">

        <p>Sanitizer that splits lists of names into their components.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>delimiters</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the set of characters to be used for
        splitting the list. (default: ',;')</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>








  <div class="doc doc-children">











  </div>

    </div>

</div><h5 id="strip-brace-terms">strip-brace-terms<a class="headerlink" href="#strip-brace-terms" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.strip_brace_terms"></a>
    <div class="doc doc-contents first">

        <p>This sanitizer creates additional name variants for names that have
addendums in brackets (e.g. "Halle (Saale)"). The additional variant contains
only the main name part with the bracket part removed.</p>








  <div class="doc doc-children">











  </div>

    </div>

</div><h5 id="tag-analyzer-by-language">tag-analyzer-by-language<a class="headerlink" href="#tag-analyzer-by-language" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.tag_analyzer_by_language"></a>
    <div class="doc doc-contents first">

        <p>This sanitizer sets the <code>analyzer</code> property depending on the
language of the tag. The language is taken from the suffix of the name.
If a name already has an analyzer tagged, then this is kept.</p>
<p>Arguments:</p>
<div class="codehilite"><pre><span></span><code><span class="n">filter</span><span class="o">-</span><span class="n">kind</span><span class="p">:</span><span class="w"> </span><span class="n">Restrict</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">names</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sanitizer</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">applied</span><span class="w"> </span><span class="n">to</span>
<span class="w">             </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">tags</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">expects</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span>
<span class="w">             </span><span class="n">regular</span><span class="w"> </span><span class="n">expressions</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">matched</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="s1">&#39;kind&#39;</span><span class="o">.</span>
<span class="w">             </span><span class="n">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">expected</span><span class="o">.</span>
<span class="n">whitelist</span><span class="p">:</span><span class="w"> </span><span class="n">Restrict</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">languages</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">tagged</span><span class="o">.</span>
<span class="w">           </span><span class="n">Expects</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">acceptable</span><span class="w"> </span><span class="n">suffixes</span><span class="o">.</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="n">unset</span><span class="p">,</span>
<span class="w">           </span><span class="n">all</span><span class="w"> </span><span class="mi">2</span><span class="o">-</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">3</span><span class="o">-</span><span class="n">letter</span><span class="w"> </span><span class="n">lower</span><span class="o">-</span><span class="n">case</span><span class="w"> </span><span class="n">codes</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">accepted</span><span class="o">.</span>
<span class="n">use</span><span class="o">-</span><span class="n">defaults</span><span class="p">:</span><span class="w">  </span><span class="n">Configure</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">suffix</span><span class="o">.</span>
<span class="w">               </span><span class="n">When</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variant</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="k">for</span>
<span class="w">               </span><span class="n">each</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">languages</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">country</span>
<span class="w">               </span><span class="n">the</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">in</span><span class="o">.</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s1">&#39;mono&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">variant</span><span class="w"> </span><span class="k">is</span>
<span class="w">               </span><span class="n">only</span><span class="w"> </span><span class="n">created</span><span class="p">,</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">spoken</span>
<span class="w">               </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">country</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">nothing</span><span class="w"> </span><span class="n">with</span>
<span class="w">               </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">languages</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">country</span><span class="o">.</span>
<span class="n">mode</span><span class="p">:</span><span class="w"> </span><span class="n">Define</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">variants</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="s1">&#39;replace&#39;</span><span class="w"> </span><span class="ow">or</span>
<span class="w">      </span><span class="s1">&#39;append&#39;</span><span class="o">.</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s1">&#39;append&#39;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="p">(</span><span class="n">without</span>
<span class="w">      </span><span class="n">any</span><span class="w"> </span><span class="n">analyzer</span><span class="w"> </span><span class="n">tagged</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">retained</span><span class="o">.</span><span class="w"> </span><span class="p">(</span><span class="n">default</span><span class="p">:</span><span class="w"> </span><span class="n">replace</span><span class="p">)</span>
</code></pre></div>








  <div class="doc doc-children">











  </div>

    </div>

</div><h5 id="clean-housenumbers">clean-housenumbers<a class="headerlink" href="#clean-housenumbers" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.clean_housenumbers"></a>
    <div class="doc doc-contents first">

        <p>Sanitizer that preprocesses address tags for house numbers. The sanitizer
allows to</p>
<ul>
<li>define which tags are to be considered house numbers (see 'filter-kind')</li>
<li>split house number lists into individual numbers (see 'delimiters')</li>
</ul>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>delimiters</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the set of characters to be used for
        splitting a list of house numbers into parts. (default: ',;')</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter-kind</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the address tags that are considered to be a
         house number. Either takes a single string or a list of strings,
         where each string is a regular expression. An address item
         is considered a house number if the 'kind' fully matches any
         of the given regular expressions. (default: 'housenumber')</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>convert-to-name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define house numbers that should be treated as a name
             instead of a house number. Either takes a single string
             or a list of strings, where each string is a regular
             expression that must match the full house number value.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>








  <div class="doc doc-children">











  </div>

    </div>

</div><h5 id="clean-postcodes">clean-postcodes<a class="headerlink" href="#clean-postcodes" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.clean_postcodes"></a>
    <div class="doc doc-contents first">

        <p>Sanitizer that filters postcodes by their officially allowed pattern.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>convert-to-address</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If set to 'yes' (the default), then postcodes that do
                not conform with their country-specific pattern are
                converted to an address component. That means that
                the postcode does not take part when computing the
                postcode centroids of a country but is still searchable.
                When set to 'no', non-conforming postcodes are not
                searchable either.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default-pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pattern to use, when there is none available for the
                country in question. Warning: will not be used for
                objects that have no country assigned. These are always
                assumed to have no postcode.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>








  <div class="doc doc-children">











  </div>

    </div>

</div><h5 id="clean-tiger-tags">clean-tiger-tags<a class="headerlink" href="#clean-tiger-tags" title="Permanent link">🔗</a></h5>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.clean_tiger_tags"></a>
    <div class="doc doc-contents first">

        <p>Sanitizer that preprocesses tags from the TIGER import.</p>
<p>It makes the following changes:</p>
<ul>
<li>remove state reference from tiger:county</li>
</ul>








  <div class="doc doc-children">











  </div>

    </div>

</div><h4 id="delete-tags">delete-tags<a class="headerlink" href="#delete-tags" title="Permanent link">🔗</a></h4>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.delete_tags"></a>
    <div class="doc doc-contents first">

        <p>Sanitizer which prevents certain tags from getting into the search index.
It remove tags which matches all properties given below.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define which type of tags should be considered for removal.
  There are two types of tags 'name' and 'address' tags.
  Takes a string 'name' or 'address'. (default: 'name')</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter-kind</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define which 'kind' of tags should be removed.
         Takes a string or list of strings where each
         string is a regular expression. A tag is considered
         to be a candidate for removal if its 'kind' property
         fully matches any of the given regular expressions.
         Note that by default all 'kind' of tags are considered.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suffix</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the 'suffix' property of the tags which should be
    removed. Takes a string or list of strings where each
    string is a regular expression. A tag is considered to be a
    candidate for removal if its 'suffix' property fully
    matches any of the given regular expressions. Note that by
    default tags with any suffix value are considered including
    those which don't have a suffix at all.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the 'name' property corresponding to the 'kind' property
  of the tag. Takes a string or list of strings where each string
  is a regular expression. A tag is considered to be a candidate
  for removal if its name fully matches any of the given regular
  expressions. Note that by default tags with any 'name' are
  considered.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>country_code</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the country code of places whose tags should be
          considered for removed. Takes a string or list of strings
          where each string is a two-letter lower-case country code.
          Note that by default tags of places with any country code
          are considered including those which don't have a country
          code at all.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rank_address</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define the address rank of places whose tags should be
          considered for removal. Takes a string or list of strings
          where each string is a number or range of number or the
          form <from>-<to>.
          Note that default is '0-30', which means that tags of all
          places are considered.
          See https://nominatim.org/release-docs/latest/customize/Ranking/#address-rank
          to learn more about address rank.</p>
              </div>
              <p>
              </p>
            </td>
          </tr>
      </tbody>
    </table>








  <div class="doc doc-children">











  </div>

    </div>

</div><h4 id="tag-japanese">tag-japanese<a class="headerlink" href="#tag-japanese" title="Permanent link">🔗</a></h4>


<div class="doc doc-object doc-module">



<a id="nominatim_db.tokenizer.sanitizers.tag_japanese"></a>
    <div class="doc doc-contents first">

        <p>This sanitizer maps OSM data to Japanese block addresses.
It replaces blocknumber and housenumber with housenumber,
and quarter and neighbourhood with place.</p>








  <div class="doc doc-children">











  </div>

    </div>

</div><h4 id="token-analysis">Token Analysis<a class="headerlink" href="#token-analysis" title="Permanent link">🔗</a></h4>
<p>Token analyzers take a full name and transform it into one or more normalized
form that are then saved in the search index. In its simplest form, the
analyzer only applies the transliteration rules. More complex analyzers
create additional spelling variants of a name. This is useful to handle
decomposition and abbreviation.</p>
<p>The ICU tokenizer may use different analyzers for different names. To select
the analyzer to be used, the name must be tagged with the <code>analyzer</code> attribute
by a sanitizer (see for example the
<a href="#tag-analyzer-by-language">tag-analyzer-by-language sanitizer</a>).</p>
<p>The token-analysis section contains the list of configured analyzers. Each
analyzer must have an <code>id</code> parameter that uniquely identifies the analyzer.
The only exception is the default analyzer that is used when no special
analyzer was selected. There are analysers with special ids:</p>
<ul>
<li>'@housenumber'. If an analyzer with that name is present, it is used
   for normalization of house numbers.</li>
<li>'@potcode'. If an analyzer with that name is present, it is used
   for normalization of postcodes.</li>
</ul>
<p>Different analyzer implementations may exist. To select the implementation,
the <code>analyzer</code> parameter must be set. The different implementations are
described in the following.</p>
<h5 id="generic-token-analyzer">Generic token analyzer<a class="headerlink" href="#generic-token-analyzer" title="Permanent link">🔗</a></h5>
<p>The generic analyzer <code>generic</code> is able to create variants from a list of given
abbreviation and decomposition replacements and introduce spelling variations.</p>
<h6 id="variants">Variants<a class="headerlink" href="#variants" title="Permanent link">🔗</a></h6>
<p>The optional 'variants' section defines lists of replacements which create alternative
spellings of a name. To create the variants, a name is scanned from left to
right and the longest matching replacement is applied until the end of the
string is reached.</p>
<p>The variants section must contain a list of replacement groups. Each group
defines a set of properties that describes where the replacements are
applicable. In addition, the word section defines the list of replacements
to be made. The basic replacement description is of the form:</p>
<div class="highlight"><pre><span></span><code>&lt;source&gt;[,&lt;source&gt;[...]] =&gt; &lt;target&gt;[,&lt;target&gt;[...]]
</code></pre></div>
<p>The left side contains one or more <code>source</code> terms to be replaced. The right side
lists one or more replacements. Each source is replaced with each replacement
term.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The source and target terms are internally normalized using the
normalization rules given in the configuration. This ensures that the
strings match as expected. In fact, it is better to use unnormalized
words in the configuration because then it is possible to change the
rules for normalization later without having to adapt the variant rules.</p>
</div>
<h6 id="decomposition">Decomposition<a class="headerlink" href="#decomposition" title="Permanent link">🔗</a></h6>
<p>In its standard form, only full words match against the source. There
is a special notation to match the prefix and suffix of a word:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~strasse =&gt; str</span><span class="w">  </span><span class="c1"># matches &quot;strasse&quot; as full word and in suffix position</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hinter~ =&gt; hntr</span><span class="w">  </span><span class="c1"># matches &quot;hinter&quot; as full word and in prefix position</span>
</code></pre></div>
<p>There is no facility to match a string in the middle of the word. The suffix
and prefix notation automatically trigger the decomposition mode: two variants
are created for each replacement, one with the replacement attached to the word
and one separate. So in above example, the tokenization of "hauptstrasse" will
create the variants "hauptstr" and "haupt str". Similarly, the name "rote strasse"
triggers the variants "rote str" and "rotestr". By having decomposition work
both ways, it is sufficient to create the variants at index time. The variant
rules are not applied at query time.</p>
<p>To avoid automatic decomposition, use the '|' notation:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~strasse |=&gt; str</span>
</code></pre></div>
<p>simply changes "hauptstrasse" to "hauptstr" and "rote strasse" to "rote str".</p>
<h6 id="initial-and-final-terms">Initial and final terms<a class="headerlink" href="#initial-and-final-terms" title="Permanent link">🔗</a></h6>
<p>It is also possible to restrict replacements to the beginning and end of a
name:</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">^south =&gt; s</span><span class="w">  </span><span class="c1"># matches only at the beginning of the name</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">road$ =&gt; rd</span><span class="w">  </span><span class="c1"># matches only at the end of the name</span>
</code></pre></div>
<p>So the first example would trigger a replacement for "south 45th street" but
not for "the south beach restaurant".</p>
<h6 id="replacements-vs-variants">Replacements vs. variants<a class="headerlink" href="#replacements-vs-variants" title="Permanent link">🔗</a></h6>
<p>The replacement syntax <code>source =&gt; target</code> works as a pure replacement. It changes
the name instead of creating a variant. To create an additional version, you'd
have to write <code>source =&gt; source,target</code>. As this is a frequent case, there is
a shortcut notation for it:</p>
<div class="highlight"><pre><span></span><code>&lt;source&gt;[,&lt;source&gt;[...]] -&gt; &lt;target&gt;[,&lt;target&gt;[...]]
</code></pre></div>
<p>The simple arrow causes an additional variant to be added. Note that
decomposition has an effect here on the source as well. So a rule</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;~strasse</span><span class="nv"> </span><span class="s">-&gt;</span><span class="nv"> </span><span class="s">str&quot;</span>
</code></pre></div>
<p>means that for a word like <code>hauptstrasse</code> four variants are created:
<code>hauptstrasse</code>, <code>haupt strasse</code>, <code>hauptstr</code> and <code>haupt str</code>.</p>
<h6 id="mutations">Mutations<a class="headerlink" href="#mutations" title="Permanent link">🔗</a></h6>
<p>The 'mutation' section in the configuration describes an additional set of
replacements to be applied after the variants have been computed.</p>
<p>Each mutation is described by two parameters: <code>pattern</code> and <code>replacements</code>.
The pattern must contain a single regular expression to search for in the
variant name. The regular expressions need to follow the syntax for
<a href="file:///usr/share/doc/python3-doc/html/library/re.html#regular-expression-syntax">Python regular expressions</a>.
Capturing groups are not permitted.
<code>replacements</code> must contain a list of strings that the pattern
should be replaced with. Each occurrence of the pattern is replaced with
all given replacements. Be mindful of combinatorial explosion of variants.</p>
<h6 id="modes">Modes<a class="headerlink" href="#modes" title="Permanent link">🔗</a></h6>
<p>The generic analyser supports a special mode <code>variant-only</code>. When configured
then it consumes the input token and emits only variants (if any exist). Enable
the mode by adding:</p>
<div class="highlight"><pre><span></span><code>  mode: variant-only
</code></pre></div>
<p>to the analyser configuration.</p>
<h5 id="housenumber-token-analyzer">Housenumber token analyzer<a class="headerlink" href="#housenumber-token-analyzer" title="Permanent link">🔗</a></h5>
<p>The analyzer <code>housenumbers</code> is purpose-made to analyze house numbers. It
creates variants with optional spaces between numbers and letters. Thus,
house numbers of the form '3 a', '3A', '3-A' etc. are all considered equivalent.</p>
<p>The analyzer cannot be customized.</p>
<h5 id="postcode-token-analyzer">Postcode token analyzer<a class="headerlink" href="#postcode-token-analyzer" title="Permanent link">🔗</a></h5>
<p>The analyzer <code>postcodes</code> is pupose-made to analyze postcodes. It supports
a 'lookup' variant of the token, which produces variants with optional
spaces. Use together with the clean-postcodes sanitizer.</p>
<p>The analyzer cannot be customized.</p>
<h3 id="reconfiguration">Reconfiguration<a class="headerlink" href="#reconfiguration" title="Permanent link">🔗</a></h3>
<p>Changing the configuration after the import is currently not possible, although
this feature may be added at a later time.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Nominatim developer community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nominatim.org/customize/Result-Formatting/">
      
      
        <link rel="prev" href="../Settings/">
      
      
        <link rel="next" href="../Country-Settings/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>API Result Formatting - Nominatim 5.1.0 Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra.css">
    
      <link rel="stylesheet" href="../../styles.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#changing-the-appearance-of-results-in-the-server-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nominatim 5.1.0 Manual" class="md-header__button md-logo" aria-label="Nominatim 5.1.0 Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nominatim 5.1.0 Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Result Formatting
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openstreetmap/Nominatim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/Overview/" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../admin/Installation/" class="md-tabs__link">
          
  
  Administration Guide

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../Overview/" class="md-tabs__link">
          
  
  Customization Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../library/Getting-Started/" class="md-tabs__link">
          
  
  Library Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../develop/overview/" class="md-tabs__link">
          
  
  Developers Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nominatim 5.1.0 Manual" class="md-nav__button md-logo" aria-label="Nominatim 5.1.0 Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nominatim 5.1.0 Manual
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openstreetmap/Nominatim" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Reverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Lookup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Address Lookup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Details/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Details
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Place Output Formats
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/Faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administration Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Administration Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Import/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Deployment-Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Setup-Nominatim-UI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nominatim UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Advanced-Installations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced Installations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration from older Versions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Install-on-Ubuntu-22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation on Ubuntu 22
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/Install-on-Ubuntu-24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation on Ubuntu 24
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Customization Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Customization Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Import-Styles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import Styles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Result Formatting
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Result Formatting
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#defining-custom-result-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Defining custom result formatting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-formatting-function" class="md-nav__link">
    <span class="md-ellipsis">
      The formatting function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-new-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Adding new formats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding new formats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#content-type-of-new-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Content type of new formats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formatting-error-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Formatting error messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-custom-formatters" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging custom formatters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formatdispatcher" class="md-nav__link">
    <span class="md-ellipsis">
      FormatDispatcher
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jsonwriter" class="md-nav__link">
    <span class="md-ellipsis">
      JsonWriter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-for-different-result-types" class="md-nav__link">
    <span class="md-ellipsis">
      Options for different result types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options for different result types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statusresult" class="md-nav__link">
    <span class="md-ellipsis">
      StatusResult
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detailedresult" class="md-nav__link">
    <span class="md-ellipsis">
      DetailedResult
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#searchresults" class="md-nav__link">
    <span class="md-ellipsis">
      SearchResults
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverseresults" class="md-nav__link">
    <span class="md-ellipsis">
      ReverseResults
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rawdatalist" class="md-nav__link">
    <span class="md-ellipsis">
      RawDataList
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Country-Settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Per-Country Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ranking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Place Ranking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Importance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Importance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tokenizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tokenizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Special-Phrases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Special Phrases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Tiger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External data: US housenumbers from TIGER
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Postcodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External data: Postcodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SQLite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion to SQLite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Library Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Library Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Getting-Started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/NominatimAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nominatim API class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Input-Parameter-Types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input Parameter Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Result-Handling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Result Handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../library/Low-Level-DB-Access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Low-level DB Access
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developers Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Database-Layout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Layout
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Indexing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Tokenizers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tokenizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/ICU-Tokenizer-Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom modules for ICU tokenizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Development-Environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup for Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/Testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../develop/data-sources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Data Sources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="changing-the-appearance-of-results-in-the-server-api">Changing the Appearance of Results in the Server API<a class="headerlink" href="#changing-the-appearance-of-results-in-the-server-api" title="Permanent link">🔗</a></h1>
<p>The Nominatim Server API offers a number of formatting options that
present search results in <a href="../../api/Output/">different output formats</a>.
These results only contain a subset of all the information that Nominatim
has about the result. This page explains how to adapt the result output
or add additional result formatting.</p>
<h2 id="defining-custom-result-formatting">Defining custom result formatting<a class="headerlink" href="#defining-custom-result-formatting" title="Permanent link">🔗</a></h2>
<p>To change the result output, you need to place a file <code>api/v1/format.py</code>
into your project directory. This file needs to define a single variable
<code>dispatch</code> containing a <a href="#formatdispatcher">FormatDispatcher</a>. This class
serves to collect the functions for formatting the different result types
and offers helper functions to apply the formatters.</p>
<p>There are two ways to define the <code>dispatch</code> variable. If you want to reuse
the default output formatting and just make some changes or add an additional
format type, then import the dispatch object from the default API:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">nominatim_api.v1.format</span> <span class="kn">import</span> <span class="n">dispatch</span> <span class="k">as</span> <span class="n">dispatch</span>
</code></pre></div>
<p>If you prefer to define a completely new result output, then you can
create an empty dispatcher object:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">nominatim_api</span> <span class="kn">import</span> <span class="n">FormatDispatcher</span>

<span class="n">dispatch</span> <span class="o">=</span> <span class="n">FormatDispatcher</span><span class="p">()</span>
</code></pre></div>
<h2 id="the-formatting-function">The formatting function<a class="headerlink" href="#the-formatting-function" title="Permanent link">🔗</a></h2>
<p>The dispatcher organises the formatting functions by format and result type.
The format corresponds to the <code>format</code> parameter of the API. It can contain
one of the predefined format names or you can invent your own new format.</p>
<p>API calls return data classes or an array of a data class which represent
the result. You need to make sure there are formatters defined for the
following result types:</p>
<ul>
<li>StatusResult (single object, returned by <code>/status</code>)</li>
<li>DetailedResult (single object, returned by <code>/details</code>)</li>
<li>SearchResults (list of objects, returned by <code>/search</code>)</li>
<li>ReverseResults (list of objects, returned by <code>/reverse</code> and <code>/lookup</code>)</li>
<li>RawDataList (simple object, returned by <code>/deletable</code> and <code>/polygons</code>)</li>
</ul>
<p>A formatter function has the following signature:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">format_func</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="n">ResultType</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>
<p>The options dictionary contains additional information about the original
query. See the <a href="#options-for-different-result-types">reference below</a>
about the possible options.</p>
<p>To set the result formatter for a certain result type and format, you need
to write the format function and decorate it with the
<a href="#nominatim_api.FormatDispatcher.format_func"><code>format_func</code></a>
decorator.</p>
<p>For example, let us extend the result for the status call in text format
and add the server URL. Such a formatter would look like this:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">nominatim_api</span> <span class="kn">import</span> <span class="n">StatusResult</span>

<span class="nd">@dispatch</span><span class="o">.</span><span class="n">format_func</span><span class="p">(</span><span class="n">StatusResult</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_format_status_text</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
    <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;Status for server nominatim.openstreetmap.org&#39;</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">ERROR: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">OK&quot;</span>
</code></pre></div>
<p>If your dispatcher is derived from the default one, then this definition
will overwrite the original formatter function. This way it is possible
to customize the output of selected results.</p>
<h2 id="adding-new-formats">Adding new formats<a class="headerlink" href="#adding-new-formats" title="Permanent link">🔗</a></h2>
<p>You may also define a completely different output format. This is as simple
as adding formatting functions for all result types using the custom
format name:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">nominatim_api</span> <span class="kn">import</span> <span class="n">StatusResult</span>

<span class="nd">@dispatch</span><span class="o">.</span><span class="n">format_func</span><span class="p">(</span><span class="n">StatusResult</span><span class="p">,</span> <span class="s1">&#39;chatty&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_format_status_text</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;The server is currently not running. </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="s2">&quot;Good news! The server is running just fine.&quot;</span>
</code></pre></div>
<p>That's all. Nominatim will automatically pick up the new format name and
will allow the user to use it. There is no need to implement formatter
functions for all the result types, when you invent a new one. The
available formats will be determined for each API endpoint separately.
To find out which formats are available, you can use the <code>--list-formats</code>
option of the CLI tool:</p>
<div class="highlight"><pre><span></span><code>me@machine:planet-project$ nominatim status --list-formats
2024-08-16 19:54:00: Using project directory: /home/nominatim/planet-project
text
json
chatty
debug
me@machine:planet-project$
</code></pre></div>
<p>The <code>debug</code> format listed in the last line will always appear. It is a
special format that enables debug output via the command line (the same
as the <code>debug=1</code> parameter enables for the server API). To not clash
with this built-in function, you shouldn't name your own format 'debug'.</p>
<h3 id="content-type-of-new-formats">Content type of new formats<a class="headerlink" href="#content-type-of-new-formats" title="Permanent link">🔗</a></h3>
<p>All responses will be returned with the content type application/json by
default. If your format produces a different content type, you need
to configure the content type with the <code>set_content_type()</code> function.</p>
<p>For example, the 'chatty' format above returns just simple text. So the
content type should be set up as:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">nominatim_api.server.content_types</span> <span class="kn">import</span> <span class="n">CONTENT_TEXT</span>

<span class="n">dispatch</span><span class="o">.</span><span class="n">set_content_type</span><span class="p">(</span><span class="s1">&#39;chatty&#39;</span><span class="p">,</span> <span class="n">CONTENT_TEXT</span><span class="p">)</span>
</code></pre></div>
<p>The <code>content_types</code> module used above provides constants for the most
frequent content types. You set the content type to an arbitrary string,
if the content type you need is not available.</p>
<h2 id="formatting-error-messages">Formatting error messages<a class="headerlink" href="#formatting-error-messages" title="Permanent link">🔗</a></h2>
<p>Any exception thrown during processing of a request is given to
a special error formatting function. It takes the requested content type,
the status code and the error message. It should return the error message
in a form appropriate for the given content type.</p>
<p>You can overwrite the default formatting function with the decorator
<code>error_format_func</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">nominatim_api.server.content_types</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="nd">@dispatch</span><span class="o">.</span><span class="n">error_format_func</span>
<span class="k">def</span> <span class="nf">_format_error</span><span class="p">(</span><span class="n">content_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="n">ct</span><span class="o">.</span><span class="n">CONTENT_XML</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="s2">                     &lt;message&gt;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&lt;/message&gt;</span>
<span class="s2">                &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">content_type</span> <span class="o">==</span> <span class="n">ct</span><span class="o">.</span><span class="n">CONTENT_JSON</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ERROR: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<h2 id="debugging-custom-formatters">Debugging custom formatters<a class="headerlink" href="#debugging-custom-formatters" title="Permanent link">🔗</a></h2>
<p>The easiest way to try out your custom formatter is by using the Nominatim
CLI commands. Custom formats can be chosen with the <code>--format</code> parameter:</p>
<div class="highlight"><pre><span></span><code>me@machine:planet-project$ nominatim status --format chatty
2024-08-16 19:54:00: Using project directory: /home/nominatim/planet-project
Good news! The server is running just fine.
me@machine:planet-project$
</code></pre></div>
<p>They will also emit full error messages when there is a problem with the
code you need to debug.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>In some cases, when you make an error with your import statement, the
CLI will not give you an error but instead tell you, that the API
commands are no longer available:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">me</span><span class="err">@</span><span class="nx">machine</span><span class="p">:</span><span class="w"> </span><span class="nx">nominatim</span><span class="w"> </span><span class="nx">status</span>
<span class="nx">usage</span><span class="p">:</span><span class="w"> </span><span class="nx">nominatim</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="nx">h</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="nx">version</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="kn">import</span><span class="p">,</span><span class="nx">freeze</span><span class="p">,</span><span class="nx">replication</span><span class="p">,</span><span class="nx">special</span><span class="o">-</span><span class="nx">phrases</span><span class="p">,</span><span class="nx">add</span><span class="o">-</span><span class="nx">data</span><span class="p">,</span><span class="nx">index</span><span class="p">,</span><span class="nx">refresh</span><span class="p">,</span><span class="nx">admin</span><span class="p">}</span><span class="w"> </span><span class="o">...</span>
<span class="nx">nominatim</span><span class="p">:</span><span class="w"> </span><span class="nx">error</span><span class="p">:</span><span class="w"> </span><span class="nx">argument</span><span class="w"> </span><span class="nx">subcommand</span><span class="p">:</span><span class="w"> </span><span class="nx">invalid</span><span class="w"> </span><span class="kd">choice</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">status</span><span class="err">&#39;</span>
</code></pre></div>

<p>This happens because the CLI tool is meant to still work when the
nominatim-api package is not installed. Import errors involving
<code>nominatim_api</code> are interpreted as "package not installed".</p>
<p>Use the help command to find out which is the offending import that
could not be found:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">me</span><span class="err">@</span><span class="nx">machine</span><span class="p">:</span><span class="w"> </span><span class="nx">nominatim</span><span class="w"> </span><span class="o">-</span><span class="nx">h</span>
<span class="o">...</span><span class="w"> </span><span class="p">[</span><span class="nx">other</span><span class="w"> </span><span class="nx">help</span><span class="w"> </span><span class="nx">text</span><span class="p">]</span><span class="w"> </span><span class="o">...</span>
<span class="nx">Nominatim</span><span class="w"> </span><span class="nx">API</span><span class="w"> </span><span class="kn">package</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">found</span><span class="w"> </span><span class="p">(</span><span class="nx">was</span><span class="w"> </span><span class="nx">looking</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">module</span><span class="p">:</span><span class="w"> </span><span class="nx">nominatim_api</span><span class="p">.</span><span class="nx">xxx</span><span class="p">).</span>
</code></pre></div>

</div>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">🔗</a></h2>
<h3 id="formatdispatcher">FormatDispatcher<a class="headerlink" href="#formatdispatcher" title="Permanent link">🔗</a></h3>


<div class="doc doc-object doc-class">



<a id="nominatim_api.FormatDispatcher"></a>
    <div class="doc doc-contents first">


        <p>Container for formatting functions for results.
Functions can conveniently be added by using decorated functions.</p>









  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.error_format_func" class="doc doc-heading">
            <code class=" language-python"><span class="n">error_format_func</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.error_format_func" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Decorator for a function that formats error messges.
There is only one error formatter per dispatcher. Using
the decorator repeatedly will overwrite previous functions.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.format_error" class="doc doc-heading">
            <code class=" language-python"><span class="n">format_error</span><span class="p">(</span><span class="n">content_type</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.format_error" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Convert the given error message into a response string
taking the requested content_type into account.</p>
<p>Change the format using the error_format_func decorator.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.format_func" class="doc doc-heading">
            <code class=" language-python"><span class="n">format_func</span><span class="p">(</span><span class="n">result_class</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.format_func" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Decorator for a function that formats a given type of result into the
selected format.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.format_result" class="doc doc-heading">
            <code class=" language-python"><span class="n">format_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.format_result" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Convert the given result into a string using the given format.</p>
<p>The format is expected to be in the list returned by
<code>list_formats()</code>.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.get_content_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_content_type</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.get_content_type" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Return the content type for the given format.</p>
<p>If no explicit content type has been defined, then
JSON format is assumed.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.list_formats" class="doc doc-heading">
            <code class=" language-python"><span class="n">list_formats</span><span class="p">(</span><span class="n">result_type</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.list_formats" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Return a list of formats supported by this formatter.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.set_content_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_content_type</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="n">content_type</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.set_content_type" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Set the content type for the given format. This is the string
that will be returned in the Content-Type header of the HTML
response, when the given format is choosen.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.FormatDispatcher.supports_format" class="doc doc-heading">
            <code class=" language-python"><span class="n">supports_format</span><span class="p">(</span><span class="n">result_type</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span></code>

<a href="#nominatim_api.FormatDispatcher.supports_format" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Check if the given format is supported by this formatter.</p>

    </div>

</div>




  </div>

    </div>

</div><h3 id="jsonwriter">JsonWriter<a class="headerlink" href="#jsonwriter" title="Permanent link">🔗</a></h3>


<div class="doc doc-object doc-class">



<a id="nominatim_api.utils.json_writer.JsonWriter"></a>
    <div class="doc doc-contents first">


        <p>JSON encoder that renders the output directly into an output
stream. This is a very simple writer which produces JSON in a
compact as possible form.</p>
<p>The writer does not check for syntactic correctness. It is the
responsibility of the caller to call the write functions in an
order that produces correct JSON.</p>
<p>All functions return the writer object itself so that function
calls can be chained.</p>









  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">()</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.__call__" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Return the rendered JSON content as a string.
The writer remains usable after calling this function.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.end_array" class="doc doc-heading">
            <code class=" language-python"><span class="n">end_array</span><span class="p">()</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.end_array" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write the closing bracket of a JSON array.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.end_object" class="doc doc-heading">
            <code class=" language-python"><span class="n">end_object</span><span class="p">()</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.end_object" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write the closing bracket of a JSON object.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.float" class="doc doc-heading">
            <code class=" language-python"><span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.float" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write out a float value with the given precision.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.key" class="doc doc-heading">
            <code class=" language-python"><span class="n">key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.key" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write the key string of a JSON object.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.keyval" class="doc doc-heading">
            <code class=" language-python"><span class="n">keyval</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.keyval" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write out an object element with the given key and value.
This is a shortcut for calling 'key()', 'value()' and 'next()'.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.keyval_not_none" class="doc doc-heading">
            <code class=" language-python"><span class="n">keyval_not_none</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.keyval_not_none" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write out an object element only if the value is not None.
If 'transform' is given, it must be a function that takes the
value type and returns a JSON encodable type. The transform
function will be called before the value is written out.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.next" class="doc doc-heading">
            <code class=" language-python"><span class="nb">next</span><span class="p">()</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.next" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write out a delimiter comma between JSON object or array elements.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.raw" class="doc doc-heading">
            <code class=" language-python"><span class="n">raw</span><span class="p">(</span><span class="n">raw_json</span><span class="p">)</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.raw" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write out the given value as is. This function is useful if
a value is already available in JSON format.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.start_array" class="doc doc-heading">
            <code class=" language-python"><span class="n">start_array</span><span class="p">()</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.start_array" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write the opening bracket of a JSON array.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.start_object" class="doc doc-heading">
            <code class=" language-python"><span class="n">start_object</span><span class="p">()</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.start_object" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write the open bracket of a JSON object.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h6 id="nominatim_api.utils.json_writer.JsonWriter.value" class="doc doc-heading">
            <code class=" language-python"><span class="n">value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#nominatim_api.utils.json_writer.JsonWriter.value" class="headerlink" title="Permanent link">🔗</a></h6>


    <div class="doc doc-contents ">

        <p>Write out a value as JSON. The function uses the json.dumps()
function for encoding the JSON. Thus any value that can be
encoded by that function is permissible here.</p>

    </div>

</div>




  </div>

    </div>

</div><h3 id="options-for-different-result-types">Options for different result types<a class="headerlink" href="#options-for-different-result-types" title="Permanent link">🔗</a></h3>
<p>This section lists the options that may be handed in with the different result
types in the v1 version of the Nominatim API.</p>
<h4 id="statusresult">StatusResult<a class="headerlink" href="#statusresult" title="Permanent link">🔗</a></h4>
<p><em>None.</em></p>
<h4 id="detailedresult">DetailedResult<a class="headerlink" href="#detailedresult" title="Permanent link">🔗</a></h4>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>locales</td>
<td><a href="../../library/Result-Handling/#locale">Locale</a> object for the requested language(s)</td>
</tr>
<tr>
<td>group_hierarchy</td>
<td>Setting of <a href="../../api/Details/#output-details">group_hierarchy</a> parameter</td>
</tr>
<tr>
<td>icon_base_url</td>
<td>(optional) URL pointing to icons as set in <a href="../Settings/#nominatim_mapicon_url">NOMINATIM_MAPICON_URL</a></td>
</tr>
</tbody>
</table>
<h4 id="searchresults">SearchResults<a class="headerlink" href="#searchresults" title="Permanent link">🔗</a></h4>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Original query string</td>
</tr>
<tr>
<td>more_url</td>
<td>URL for requesting additional results for the same query</td>
</tr>
<tr>
<td>exclude_place_ids</td>
<td>List of place IDs already returned</td>
</tr>
<tr>
<td>viewbox</td>
<td>Setting of <a href="../../api/Search/#result-restriction">viewbox</a> parameter</td>
</tr>
<tr>
<td>extratags</td>
<td>Setting of <a href="../../api/Search/#output-details">extratags</a> parameter</td>
</tr>
<tr>
<td>namedetails</td>
<td>Setting of <a href="../../api/Search/#output-details">namedetails</a> parameter</td>
</tr>
<tr>
<td>addressdetails</td>
<td>Setting of <a href="../../api/Search/#output-details">addressdetails</a> parameter</td>
</tr>
</tbody>
</table>
<h4 id="reverseresults">ReverseResults<a class="headerlink" href="#reverseresults" title="Permanent link">🔗</a></h4>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>Original query string</td>
</tr>
<tr>
<td>extratags</td>
<td>Setting of <a href="../../api/Search/#output-details">extratags</a> parameter</td>
</tr>
<tr>
<td>namedetails</td>
<td>Setting of <a href="../../api/Search/#output-details">namedetails</a> parameter</td>
</tr>
<tr>
<td>addressdetails</td>
<td>Setting of <a href="../../api/Search/#output-details">addressdetails</a> parameter</td>
</tr>
</tbody>
</table>
<h4 id="rawdatalist">RawDataList<a class="headerlink" href="#rawdatalist" title="Permanent link">🔗</a></h4>
<p><em>None.</em></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; Nominatim developer community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>